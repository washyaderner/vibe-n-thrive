---
const tiers = [
  {
    name: 'Drop-In Alignment',
    sessions: null,
    price: '$70 – $100',
    perSession: 'sliding scale',
    description: 'A one-time reset session to ground, reconnect and bring your system back into harmony.',
    features: [
      'Single session — no commitment',
      'Personalized frequency calibration',
      'Post-session wellness guidance',
    ],
    featured: false,
  },
  {
    name: 'The Reset',
    sessions: 4,
    price: '$240',
    perSession: '$60/session',
    description: 'A short journey to begin realignment, perfect for sharpening clarity, sleep and emotional flow.',
    features: [
      '4 progressive sessions',
      'Personalized treatment plan',
      'Clarity & sleep improvement focus',
      'Session-to-session tracking',
    ],
    featured: false,
  },
  {
    name: 'Harmony Deep Dive',
    sessions: 8,
    price: '$440',
    perSession: '$55/session',
    description: 'Dive deeper to reinforce new patterns of peace, mindfulness and inner guidance.',
    features: [
      '8 progressive sessions',
      'Save $40 vs. drop-in rate',
      'Deep pattern reinforcement',
      'Mindfulness & inner guidance focus',
      'Extended consultation included',
    ],
    featured: true,
  },
  {
    name: 'Total Recalibration',
    sessions: 12,
    price: '$600',
    perSession: '$50/session',
    description: 'A transformative journey designed to support long-term clarity, balance and fulfillment.',
    features: [
      '12 progressive sessions',
      'Best per-session value',
      'Full transformative journey',
      'Long-term clarity & balance',
      'Priority scheduling',
      'Comprehensive wellness plan',
    ],
    featured: false,
  },
];
---

<section class="pricing section" id="pricing">
  <div class="container">
    <div class="text-center">
      <p class="section-label">Pricing</p>
      <h2 class="section-title">Your Journey to Inner Harmony</h2>
      <p class="section-subtitle" style="margin-left:auto;margin-right:auto;">
        Each session builds on the last to gently restore balance, clarity and peace.
        <br />Choose a path that fits where you are in your healing journey.
      </p>
    </div>

    <div class="pricing__grid">
      {tiers.map(tier => (
        <div class={`pricing__card glass${tier.featured ? ' pricing__card--featured' : ''}`}>
          {tier.featured && <div class="pricing__badge">Most Popular</div>}
          <h3 class="pricing__card-title">{tier.name}</h3>
          {tier.sessions && (
            <p class="pricing__sessions">{tier.sessions} Sessions</p>
          )}
          <div class="pricing__price">
            <span class="pricing__amount">{tier.price}</span>
          </div>
          <p class="pricing__per">{tier.perSession}</p>
          <p class="pricing__desc">{tier.description}</p>
          <ul class="pricing__features" role="list">
            {tier.features.map(f => (
              <li>{f}</li>
            ))}
          </ul>
          <a href="#booking" class={`btn ${tier.featured ? 'btn--primary' : 'btn--outline'}`}>Book Now</a>
        </div>
      ))}
    </div>

    <div class="pricing__events">
      <h3 class="pricing__events-title">Event Rates</h3>
      <p class="pricing__events-subtitle">Bring vibroacoustic therapy to your group event, retreat or wellness gathering.</p>
      <div class="pricing__events-options">
        <div class="pricing__events-option">
          <span class="pricing__events-amount">$350</span>
          <span class="pricing__events-duration">5 hours</span>
        </div>
        <span class="pricing__events-divider" aria-hidden="true"></span>
        <div class="pricing__events-option">
          <span class="pricing__events-amount">$500</span>
          <span class="pricing__events-duration">8 hours</span>
        </div>
      </div>
      <button class="btn btn--primary" id="events-form-toggle" aria-expanded="false" aria-controls="events-form">Inquire About Events</button>

      <form
        id="events-form"
        class="events-form"
        action="https://formspree.io/f/YOUR_FORM_ID"
        method="POST"
        hidden
      >
        <div class="events-form__grid">
          <div class="events-form__field">
            <label for="event-name">Name <span class="events-form__required">*</span></label>
            <input type="text" id="event-name" name="name" required autocomplete="name" />
          </div>
          <div class="events-form__field">
            <label for="event-email">Email <span class="events-form__required">*</span></label>
            <input type="email" id="event-email" name="email" required autocomplete="email" />
          </div>
          <div class="events-form__field">
            <label for="event-company">Company / Organization</label>
            <input type="text" id="event-company" name="company" autocomplete="organization" />
          </div>
          <div class="events-form__field">
            <label for="event-hours">Hours Needed</label>
            <select id="event-hours" name="hours">
              <option value="" selected disabled>Select an option</option>
              <option value="5 hours ($350)">5 hours ($350)</option>
              <option value="8 hours ($500)">8 hours ($500)</option>
              <option value="Not sure yet">Not sure yet</option>
              <option value="custom">Other (enter below)</option>
            </select>
            <input type="text" id="event-hours-custom" name="hours_custom" placeholder="e.g. 3 hours, full day, etc." hidden />
          </div>
          <div class="events-form__field events-form__field--full">
            <label for="event-description">Event Description <span class="events-form__required">*</span></label>
            <textarea id="event-description" name="description" rows="4" required placeholder="Tell us about your event — type, expected attendance, date, location, etc."></textarea>
          </div>
        </div>
        <button type="submit" class="btn btn--primary events-form__submit">Send Inquiry</button>
      </form>

      <div id="events-form-success" class="events-form__success" hidden>
        <p>Thanks! We'll be in touch soon.</p>
      </div>
    </div>

  </div>
</section>

<style>
  .pricing__grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
    align-items: start;
  }

  .pricing__card {
    padding: 2rem 1.5rem;
    text-align: center;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .pricing__card--featured {
    border: 2px solid var(--color-teal);
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    transform: scale(1.04);
    z-index: 1;
  }

  .pricing__badge {
    position: absolute;
    top: -14px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, var(--color-teal), var(--color-teal-dark));
    color: white;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    padding: 0.375rem 1.25rem;
    border-radius: 100px;
    white-space: nowrap;
  }

  .pricing__card-title {
    font-size: 1.1875rem;
    margin-bottom: 0.25rem;
  }

  .pricing__sessions {
    font-size: 0.8125rem;
    color: var(--color-gray-400);
    font-weight: 500;
    margin-bottom: 0.25rem;
  }

  .pricing__price {
    margin: 1.25rem 0 0.25rem;
  }

  .pricing__amount {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-gray-900);
    letter-spacing: -0.02em;
  }

  .pricing__card--featured .pricing__amount {
    font-size: 2.25rem;
  }

  .pricing__per {
    font-size: 0.8125rem;
    color: var(--color-gray-400);
    margin-bottom: 1rem;
  }

  .pricing__desc {
    font-size: 0.875rem;
    color: var(--color-gray-600);
    line-height: 1.6;
    margin-bottom: 1.5rem;
    max-width: 30ch;
  }

  .pricing__features {
    list-style: none;
    text-align: left;
    margin-bottom: 2rem;
    width: 100%;
    flex-grow: 1;
  }

  .pricing__features li {
    padding: 0.4375rem 0;
    font-size: 0.875rem;
    color: var(--color-gray-600);
    border-bottom: 1px solid rgba(0, 0, 0, 0.04);
    padding-left: 1.5rem;
    position: relative;
  }

  .pricing__features li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--color-teal-light);
  }

  .pricing__card .btn {
    width: 100%;
    justify-content: center;
    margin-top: auto;
  }

  .pricing__events {
    margin-top: 2.5rem;
    padding: 2.5rem 2rem;
    text-align: center;
  }

  .pricing__events-title {
    font-size: 1.75rem;
    margin-bottom: 0.5rem;
  }

  .pricing__events-subtitle {
    font-size: 1.1875rem;
    color: var(--color-gray-500);
    margin-bottom: 1.75rem;
    white-space: nowrap;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
  }

  .pricing__events-options {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 1.75rem;
  }

  .pricing__events-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
  }

  .pricing__events-amount {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-gray-900);
    letter-spacing: -0.02em;
  }

  .pricing__events-duration {
    font-size: 0.875rem;
    color: var(--color-gray-400);
    font-weight: 500;
  }

  .pricing__events-divider {
    width: 1px;
    height: 3rem;
    background: rgba(0, 0, 0, 0.1);
  }

  .pricing__events .btn {
    min-width: 220px;
  }

  /* --- Event Inquiry Form --- */
  .events-form {
    margin-top: 1.75rem;
    text-align: left;
    max-width: 560px;
    margin-left: auto;
    margin-right: auto;
  }

  .events-form__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  .events-form__field--full {
    grid-column: 1 / -1;
  }

  .events-form__field label {
    display: block;
    font-size: 0.8125rem;
    font-weight: 600;
    color: var(--color-gray-800);
    margin-bottom: 0.375rem;
  }

  .events-form__required {
    color: var(--color-teal);
  }

  .events-form__field input,
  .events-form__field select,
  .events-form__field textarea {
    width: 100%;
    padding: 0.625rem 0.875rem;
    border: 1px solid var(--color-gray-200);
    border-radius: 12px;
    font-family: var(--font-sans);
    font-size: 0.9375rem;
    color: var(--color-gray-800);
    background: rgba(255, 255, 255, 0.7);
    transition: border-color var(--transition-base), box-shadow var(--transition-base);
  }

  .events-form__field input:focus,
  .events-form__field select:focus,
  .events-form__field textarea:focus {
    outline: none;
    border-color: var(--color-teal);
    box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.12);
  }

  .events-form__field textarea {
    resize: vertical;
    min-height: 100px;
  }

  #event-hours-custom {
    margin-top: 0.5rem;
  }

  .events-form__submit {
    margin-top: 1.25rem;
    width: 100%;
    justify-content: center;
  }

  .events-form__success {
    margin-top: 1.75rem;
  }

  .events-form__success p {
    font-size: 1.0625rem;
    font-weight: 600;
    color: var(--color-teal-dark);
    margin: 0 auto;
  }

  @media (max-width: 600px) {
    .events-form__grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 1100px) {
    .pricing__grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 768px) {
    .pricing__card--featured {
      backdrop-filter: none;
      -webkit-backdrop-filter: none;
      background: rgba(255, 255, 255, 0.95);
    }
  }

  @media (max-width: 600px) {
    .pricing__grid {
      grid-template-columns: 1fr;
      max-width: 400px;
      margin: 0 auto;
    }

    .pricing__card--featured {
      transform: none;
    }
  }
</style>

<script>
  const toggle = document.getElementById('events-form-toggle');
  const form = document.getElementById('events-form');
  const success = document.getElementById('events-form-success');

  toggle?.addEventListener('click', () => {
    const isOpen = !form.hidden;
    form.hidden = isOpen;
    toggle.setAttribute('aria-expanded', String(!isOpen));
    if (!isOpen) {
      form.querySelector('input')?.focus();
    }
  });

  const hoursSelect = document.getElementById('event-hours');
  const hoursCustom = document.getElementById('event-hours-custom');

  hoursSelect?.addEventListener('change', () => {
    const isCustom = hoursSelect.value === 'custom';
    hoursCustom.hidden = !isCustom;
    if (isCustom) hoursCustom.focus();
  });

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const submitBtn = form.querySelector('.events-form__submit');
    submitBtn.disabled = true;
    submitBtn.textContent = 'Sending...';

    try {
      const res = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { Accept: 'application/json' },
      });

      if (res.ok) {
        form.hidden = true;
        toggle.hidden = true;
        success.hidden = false;
      } else {
        submitBtn.textContent = 'Something went wrong — try again';
        submitBtn.disabled = false;
      }
    } catch {
      submitBtn.textContent = 'Something went wrong — try again';
      submitBtn.disabled = false;
    }
  });
</script>
